category: credential-store
display_name: "Credential Store"

tests:
  # --- KeychainStore integration (PR #250) ---

  - id: MT-CRED-01
    name: "Windows Credential Manager stores credentials"
    pr: 250
    platforms: [windows]
    prerequisites:
      - app: true
    instructions:
      - "Save a password for an SSH connection"
      - "Open Windows Credential Manager"
      - "Search for 'termihub' entries"
    expected:
      - "Credentials are stored in Windows Credential Manager"
    verification: manual

  - id: MT-CRED-02
    name: "macOS Keychain stores credentials"
    pr: 250
    platforms: [macos]
    prerequisites:
      - app: true
    instructions:
      - "Save a password for an SSH connection"
      - "Open Keychain Access"
      - "Search for 'termihub' entries"
    expected:
      - "Credentials are stored in Keychain Access"
    verification: manual

  - id: MT-CRED-03
    name: "Linux Secret Service stores credentials"
    pr: 250
    platforms: [linux]
    prerequisites:
      - app: true
    instructions:
      - "Save a password for an SSH connection"
      - "Check Secret Service / D-Bus (if available)"
    expected:
      - "Credentials are stored via Secret Service"
    verification: manual

  # --- Master password unlock dialog (PR #257) ---

  - id: MT-CRED-04
    name: "Master password unlock on startup"
    pr: 257
    platforms: [all]
    prerequisites:
      - app: true
    instructions:
      - "Configure credential store to master_password mode"
      - "Lock the store"
      - "Restart the app"
    expected:
      - "Unlock dialog appears automatically on startup"
    verification: manual

  # --- Credential store auto-fill on connect (PR #258) ---

  - id: MT-CRED-05
    name: "Auto-fill credentials on agent connect"
    pr: 258
    platforms: [all]
    prerequisites:
      - app: true
      - docker: true
    instructions:
      - "Connect a remote agent with 'savePassword' enabled"
      - "Verify credentials auto-fill"
      - "Then remove the credential and reconnect"
    expected:
      - "Stored credentials are used automatically"
      - "Stale credentials trigger re-prompt after removal"
    verification: manual

  # --- Auto-lock timeout (PR #263) ---

  - id: MT-CRED-06
    name: "Auto-lock after timeout"
    pr: 263
    platforms: [all]
    prerequisites:
      - app: true
    instructions:
      - "Configure master password mode"
      - "Unlock the store"
      - "Wait for the configured timeout to elapse"
    expected:
      - "Store auto-locks and unlock dialog appears"
    verification: manual

  - id: MT-CRED-07
    name: "Activity resets inactivity timer"
    pr: 263
    platforms: [all]
    prerequisites:
      - app: true
    instructions:
      - "With store unlocked, perform credential operations"
      - "(connect with saved password, browse credentials)"
    expected:
      - "Each operation resets the inactivity timer"
      - "Store does not lock prematurely"
    verification: manual

  - id: MT-CRED-08
    name: "Timeout change takes effect immediately"
    pr: 263
    platforms: [all]
    prerequisites:
      - app: true
    instructions:
      - "Change the auto-lock timeout while the store is unlocked"
    expected:
      - "New timeout takes effect immediately"
      - "No lock/unlock cycle required"
    verification: manual
